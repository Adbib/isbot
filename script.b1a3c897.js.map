{"version":3,"sources":["../src/amend/index.js","../src/list.json","script.js"],"names":["amend","list","RegExp","test","error","splice","lastIndexOf","push","module","exports","timer","change","value","target","clearTimeout","setTimeout","check","append","parent","tag","string","ele","document","createElement","appendChild","createTextNode","details","ua","fragment","createDocumentFragment","is","isbot","found","find","pattern","matches","textarea","innerHTML","trim","output","firstChild","removeChild","className","querySelector","query","window","location","search","replace","childNodes","forEach","child","parentNode","decodeURIComponent","navigator","userAgent","addEventListener","select"],"mappings":"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","file":"script.b1a3c897.js","sourceRoot":"../page","sourcesContent":["/**\n * Mutate given list of patter strings\n * @param {string[]} list\n * @returns {string[]}\n */\nexport function amend (list) {\n  try {\n    // Risk: Uses lookbehind assertion, avoid breakage in parsing by using RegExp constructor\n    new RegExp('(?<! cu)bot').test('dangerbot') // eslint-disable-line prefer-regex-literals\n  } catch (error) {\n    // Skip regex fixes\n    return list\n  }\n\n  // Addresses: Cubot device\n  list.splice(list.lastIndexOf('bot'), 1)\n  list.push('(?<! cu)bot')\n\n  // Addresses: Android webview\n  list.splice(list.lastIndexOf('google'), 1)\n  list.push('(?<! (channel/|google/))google(?!(app|/google| pixel))')\n\n  // Addresses: Yandex browser\n  list.splice(list.lastIndexOf('search'), 1)\n  list.push('(?<! (ya|yandex))search')\n\n  // Addresses: libhttp browser\n  list.splice(list.lastIndexOf('http'), 1)\n  list.push('(?<!(lib))http')\n\n  // Addresses: java based browsers\n  list.splice(list.lastIndexOf('java'), 1)\n  list.push('java(?!;)')\n\n  // Addresses: Mozilla nightly build https://github.com/mozilla-mobile/android-components/search?q=MozacFetch\n  list.splice(list.lastIndexOf('fetch'), 1)\n  list.push('(?<!(mozac))fetch')\n\n  return list\n}\n","module.exports=[\" daum[ /]\",\" deusu/\",\"(?:^| )site\",\"@[a-z]\",\"\\\\(at\\\\)[a-z]\",\"\\\\(github\\\\.com/\",\"\\\\[at\\\\][a-z]\",\"^12345\",\"^<\",\"^[\\\\w \\\\.]+/v?\\\\d+(\\\\.\\\\d+)?(\\\\.\\\\d{1,10})?$\",\"^[\\\\w]+$\",\"^[^ ]{50,}$\",\"^ace explorer\",\"^acoon\",\"^active\",\"^ad muncher\",\"^anglesharp/\",\"^anonymous\",\"^apple-pubsub/\",\"^astute srm\",\"^avsdevicesdk/\",\"^axios/\",\"^bidtellect/\",\"^biglotron\",\"^blackboard safeassign\",\"^blocknote.net\",\"^braze sender\",\"^captivenetworksupport\",\"^castro\",\"^cf-uc \",\"^clamav[ /]\",\"^cobweb/\",\"^coccoc\",\"^custom\",\"^dap \",\"^ddg[_-]android\",\"^discourse\",\"^dispatch/\\\\d\",\"^downcast/\",\"^duckduckgo\",\"^email\",\"^enigma browser\",\"^evernote clip resolver\",\"^facebook\",\"^faraday\",\"^fdm[ /]\\\\d\",\"^getright/\",\"^gozilla/\",\"^hatena\",\"^hobbit\",\"^hotzonu\",\"^hwcdn/\",\"^infox-wisg\",\"^invision\",\"^jeode/\",\"^jetbrains\",\"^jetty/\",\"^jigsaw\",\"^linkdex\",\"^lwp[-: ]\",\"^mailchimp\\\\.com$\",\"^metauri\",\"^microsoft bits\",\"^microsoft data\",\"^microsoft office existence\",\"^microsoft office protocol discovery\",\"^microsoft windows network diagnostics\",\"^microsoft-cryptoapi\",\"^microsoft-webdav-miniredir\",\"^movabletype\",\"^mozilla/\\\\d\\\\.\\\\d \\\\(compatible;?\\\\)$\",\"^mozilla/\\\\d\\\\.\\\\d \\\\w*$\",\"^my browser$\",\"^navermailapp\",\"^netsurf\",\"^nginx\\\\W\",\"^node-superagent\",\"^octopus\",\"^offline explorer\",\"^pagething\",\"^panscient\",\"^perimeterx\",\"^php\",\"^postman\",\"^postrank\",\"^python\",\"^read\",\"^reed\",\"^request-promise$\",\"^restsharp/\",\"^shareaza\",\"^shockwave flash\",\"^snapchat\",\"^space bison\",\"^sprinklr\",\"^svn\",\"^swcd \",\"^t-online browser\",\"^taringa\",\"^test certificate info\",\"^the knowledge ai\",\"^thinklab\",\"^thumbor/\",\"^traackr.com\",\"^tumblr/\",\"^vbulletin\",\"^venus/fedoraplanet\",\"^w3c\",\"^webbandit/\",\"^webcopier\",\"^wget\",\"^whatsapp\",\"^www-mechanize\",\"^xenu link sleuth\",\"^yahoo\",\"^yandex\",\"^zdm/\\\\d\",\"^zeushdthree\",\"^zoom marketplace/\",\"adbeat\\\\.com\",\"appinsights\",\"archive\",\"ask jeeves/teoma\",\"bit\\\\.ly/\",\"bluecoat drtr\",\"bot\",\"browsex\",\"burpcollaborator\",\"capture\",\"catch\",\"check\",\"chrome-lighthouse\",\"chromeframe\",\"client\",\"cloud\",\"crawl\",\"daemon\",\"dareboost\",\"datanyze\",\"dataprovider\",\"dejaclick\",\"dmbrowser\",\"download\",\"evc-batch/\",\"feed\",\"fetch\",\"firephp\",\"freesafeip\",\"ghost\",\"gomezagent\",\"google\",\"headlesschrome/\",\"http\",\"httrack\",\"hubspot marketing grader\",\"hydra\",\"ibisbrowser\",\"images\",\"index\",\"ips-agent\",\"java\",\"library\",\"mail\\\\.ru/\",\"manager\",\"monitor\",\"morningscore/\",\"neustar wpm\",\"news\",\"nutch\",\"offbyone\",\"optimize\",\"pagespeed\",\"parse\",\"perl\",\"phantom\",\"pingdom\",\"powermarks\",\"preview\",\"probe\",\"proxy\",\"ptst[ /]\\\\d\",\"reader\",\"rexx;\",\"rigor\",\"rss\",\"scan\",\"scrape\",\"search\",\"serp ?reputation ?management\",\"server\",\"sogou\",\"sparkler/\",\"spider\",\"statuscake\",\"stumbleupon\\\\.com\",\"supercleaner\",\"synapse\",\"synthetic\",\"taginspector/\",\"toolbar\",\"torrent\",\"tracemyfile\",\"transcoder\",\"trendsmapresolver\",\"twingly recon\",\"url\",\"valid\",\"virtuoso\",\"wappalyzer\",\"webglance\",\"webkit2png\",\"websitemetadataretriever\",\"whatcms/\",\"wordpress\",\"zgrab\"];","import isbot from '..'\nimport { amend } from '../src/amend/index.js'\nimport list from '../src/list.json'\n\n{\n  const textarea = document.querySelector('textarea')\n  const output = document.querySelector('output')\n  let timer\n\n  const query = window.location.search.replace(/\\?ua=(.*)$/, '$1')\n\n  amend(list)\n\n  textarea.childNodes.forEach(child => child.parentNode?.removeChild(child))\n  textarea.appendChild(document.createTextNode(\n    query\n      ? decodeURIComponent(query)\n      : navigator.userAgent\n  )\n  )\n  textarea.addEventListener('keyup', change)\n  textarea.addEventListener('paste', change)\n  textarea.addEventListener('focus', () => textarea.select())\n  check()\n\n  function change ({ target: { value } }) {\n    clearTimeout(timer)\n    timer = setTimeout(check, 200, value)\n  }\n\n  function append (parent, tag, string) {\n    if (tag) {\n      const ele = document.createElement('kbd')\n      ele.appendChild(document.createTextNode(string))\n      parent.appendChild(ele)\n    } else {\n      parent.appendChild(document.createTextNode(string))\n    }\n  }\n\n  function details (ua) {\n    const fragment = document.createDocumentFragment()\n    const is = isbot(ua)\n    const found = is && isbot.find(ua)\n    const pattern = found\n      ? isbot.matches(ua)?.find(pattern => new RegExp(pattern, 'i').test(found))\n      : null\n\n    is\n      ? append(fragment, null, 'I think so, yes\\n')\n      : append(fragment, null, 'I don\\'t think so, no\\nI could not find a pattern I recognise')\n    found && append(fragment, null, 'The substring ')\n    found && append(fragment, 'kbd', found)\n    pattern && append(fragment, null, ' matches the pattern ')\n    pattern && append(fragment, 'kbd', pattern)\n    return fragment\n  }\n\n  function check (value = textarea.innerHTML) {\n    value = value.trim()\n    while (output.firstChild) {\n      output.removeChild(output.firstChild)\n    }\n    if (value === '') {\n      output.appendChild(\n        document.createTextNode(\n          'Insert user agent string in the text box'\n        )\n      )\n      return\n    }\n\n    output.appendChild(details(value))\n\n    output.className = ''\n    setTimeout(() => { output.className = 'highlight' }, 100)\n  }\n}\n"]}